// Generated by CoffeeScript 1.3.3
(function() {

  define(["smog/server", "smog/notify", "smog/editor", "templates/edit"], function(server, notify, editor, templ) {
    return function(_arg) {
      var edit, name, realname;
      name = _arg.name;
      realname = name.toLowerCase();
      $('#content').html(templ({
        title: 'Insert',
        id: realname,
        button: 'Insert'
      }));
      edit = editor.create("" + realname + "-edit-view", {
        mode: "javascript",
        wrap: 100,
        worker: false,
        value: "{\r\n\r\n}"
      });
      return $('#edit-button').click(function() {
        return server.collection({
          collection: realname,
          type: 'insert',
          query: edit.getText()
        }, function(err) {
          if (err != null) {
            return notify.error("Error inserting document: " + (err.err || err));
          }
          edit.destroy();
          notify.success("Document inserted!");
          return window.location.hash = "#/collection/" + name;
        });
      });
    };
  });

}).call(this);

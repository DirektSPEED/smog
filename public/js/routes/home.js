// Generated by CoffeeScript 1.3.1
(function() {

  define(["smog/server", "templates/navigation", "templates/sidebar", "smog/notify"], function(server, nav, sidebar, notify) {
    return function() {
      return server.collections(function(err, coll) {
        var it, name;
        if (err != null) {
          return notify.error("Error grabbing collections: " + err);
        }
        coll = (function() {
          var _i, _len, _results;
          _results = [];
          for (_i = 0, _len = coll.length; _i < _len; _i++) {
            it = coll[_i];
            if (it.name.indexOf('.system.') === -1) {
              _results.push(it.name.substring(it.name.indexOf('.') + 1));
            }
          }
          return _results;
        })();
        coll = (function() {
          var _i, _len, _results;
          _results = [];
          for (_i = 0, _len = coll.length; _i < _len; _i++) {
            name = coll[_i];
            _results.push("" + (name.charAt(0).toUpperCase()) + (name.slice(1)));
          }
          return _results;
        })();
        $('#navigation').html(nav({
          loggedIn: true
        }));
        $('#sidebar').html(sidebar({
          collections: coll
        }));
        return $('#content').html('');
      });
    };
  });

}).call(this);
